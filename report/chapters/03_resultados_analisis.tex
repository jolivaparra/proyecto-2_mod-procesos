\chapter{Resultados y Análisis}

\section{Caracterización de la Respuesta en Lazo Abierto}

Para dar cumplimiento al objetivo de visualizar la dinámica natural del proceso, se implementó un esquema de \textbf{Lazo Abierto} incorporando un generador de señal tipo escalón aplicado a las variables manipulables ($V_{bomb}, V_{vent}$).

En esta prueba, el sistema es sometido a las perturbaciones estandarizadas del ``Día Soleado'' (irradiancia y temperatura ambiente variables descritas en la Sección \ref{ssec:escenarios-de-simulacion}), mientras que los actuadores son activados mediante una señal fija (escalón de tensión) durante las horas de operación, sin recibir retroalimentación de la temperatura real del panel. Esta simulación fue la más efectiva en reducción de la temperatura del panel respecto a las entradas utilizadas en el Proyecto 1 \cite{proyecto1}.

La Figura~\ref{fig:plot:lazo_abierto} muestra la respuesta temporal obtenida bajo estas condiciones.

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{plots/temp-panel-actuadores-sin-control.pdf}
    \caption{Respuesta dinámica del sistema en Lazo Abierto ante una entrada tipo escalón en horas de mayor carga térmica con perturbaciones de día despejado.}
    \label{fig:plot:lazo_abierto}
\end{figure}

\subsection*{Análisis de la Respuesta Dinámica}

Del comportamiento observado en la gráfica, se desprenden las siguientes conclusiones sobre la planta:

\begin{enumerate}
    \item \textbf{Capacidad de Enfriamiento Suficiente:} Se observa que, al aplicar la señal de control fija (máxima capacidad), la temperatura máxima alcanzada es de aproximadamente \SI{51}{\degreeCelsius}. Este valor se encuentra por debajo del límite crítico de seguridad (\SI{55}{\degreeCelsius}) definido en las especificaciones de respuesta, lo que indica que los actuadores dimensionados tienen la capacidad física suficiente para disipar la carga térmica máxima del sistema si operan a plena potencia.

    \item \textbf{Dependencia de las Perturbaciones:} A pesar de que la temperatura se mantiene en rangos seguros, la curva de salida sigue parcialmente la forma de la irradiancia solar (sube al mediodía y baja al atardecer). Esto evidencia que, en lazo abierto, el sistema es incapaz de rechazar perturbaciones completamente debido a la magnitud de la inercia térmica del ambiente, por lo cual la temperatura flota libremente en función del clima, sin mantener un punto de operación constante (Set-Point) debido al escalón.

    \item \textbf{Descenso Drástico de Temperatura en Activación:} Al momento de la activación del sistema el panel sufre un descenso de temperatura cercano a \qty{10}{\degreeCelsius}, esto en el día a día conlleva un estrés térmico constante a los materiales del panel reduciendo su vida útil.

    \item \textbf{Ineficiencia Energética (El Desafío de Consumo):} La señal escalón implica que los actuadores están operando a un nivel de tensión constante incluso en momentos donde la carga térmica es baja (mañana y tarde). Esto representa un desperdicio de energía significativo, ya que se está aplicando un esfuerzo de enfriamiento máximo cuando no es estrictamente necesario.
\end{enumerate}

\paragraph{Conclusión} Si bien la operación en lazo abierto puede satisfacer el requisito de seguridad térmica bajo estas condiciones ($\approx \SI{51}{\degreeCelsius}$), carece de capacidad de regulación y eficiencia. Esto justifica la implementación de una estrategia de control en \textbf{Lazo Cerrado} que module el esfuerzo de los actuadores para mantener la temperatura estable y minimizar el consumo.

\section{Análisis de Estabilidad y Sintonización del Controlador}

Una vez caracterizada la planta, se procedió al diseño del controlador en lazo cerrado. Para determinar la ganancia proporcional ($K_c$) adecuada, se realizó un análisis de sensibilidad sometiendo al sistema al escenario de carga máxima (Día Soleado) variando la magnitud de la ganancia en el conjunto de valores $\{-0.25, -0.5, -1.0, -2.0\}$, junto con un valor de referencia para el controlador de $Ref = \qty{45}{\degreeCelsius}$ y un valor de Offset de \qty{5}{\volt}.

El objetivo de esta comparativa es encontrar el compromiso óptimo entre la velocidad de reducción de temperatura y la estabilidad de la señal de control enviada a los actuadores.

La Figura~\ref{fig:plot:comparativa-kp} presenta la superposición de las respuestas temporales y el esfuerzo de control resultante para los distintos valores de ganancia probados.

\begin{figure}[H]
    \centering
    \caption{Comparativa de valores $K_p$: cada línea corresponde al controlador con el valor de $K_p$ señalado.}
    \label{fig:plot:comparativa-kp}
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/comparativa-Kp-temp-panel.pdf}
        \caption{Temperatura (\si{\degreeCelsius}) del panel solar.}
        \label{fig:plot:comparativa-kp-a}
    \end{subfigure}
    \hfil
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/comparativa-Kp-volt.pdf}
        \caption{Tensión (\si{\volt}) aplicada en cada actuador.}
        \label{fig:plot:comparativa-kp-b}
    \end{subfigure}
\end{figure}

A partir de la visualización del comportamiento dinámico, se observan dos fenómenos contrapuestos:

\begin{enumerate}
    \item \textbf{Comportamiento con Altas Ganancias ($K_c = -1.0, -2.0$):}
          Si bien las ganancias de mayor magnitud logran acercar la temperatura a la referencia más rápidamente, se observa en el gráfico inferior de la Figura~\ref{fig:plot:comparativa-kp-b} que la señal de voltaje entra en una zona de \textbf{saturación oscilatoria} o comportamiento agresivo.
          Este fenómeno provoca cambios bruscos en la velocidad del ventilador, lo cual es indeseable mecánicamente y no se traduce en una mejora térmica significativa debido a la lenta inercia térmica del agua.

    \item \textbf{Comportamiento con Bajas Ganancias ($K_c = -0.25$):}
          Con una ganancia conservadora de $-0.25$, la respuesta de temperatura es más suave y libre de oscilaciones. Aunque presenta temperatura máxima ligeramente mayor a los demás, logra mantener la temperatura por debajo del límite de seguridad de \SI{55}{\degreeCelsius}.
          Lo más relevante es que la señal de control (Voltaje) evoluciona suavemente, siguiendo la curva de irradiancia sin saltos abruptos, lo que maximiza la vida útil de los actuadores y de los materiales del panel solar.
\end{enumerate}

\paragraph{Selección de Parámetros} Basado en este análisis, se selecciona $K_c = -0.25$ como la ganancia definitiva para el controlador. Esta sintonía prioriza la robustez y la suavidad de la actuación por sobre la velocidad de respuesta, dado que el sistema térmico es inherentemente lento y el criterio principal es la seguridad operativa ($T < \SI{55}{\degreeCelsius}$) junto a la eficiencia energética más que la precisión de seguimiento al Offset fijado.

\section{Evaluación de Desempeño Transitorio}

Habiendo seleccionado la ganancia definitiva ($K_c = -0.25$), se procede a cuantificar el desempeño dinámico del sistema mediante las métricas definidas en la Sección~\ref{sec:metricas}. Cabe aclarar que este análisis no fué posible realizarlo en la etapa de sintonización debido a la presencia de perturbaciones variables (irradiancia y temperatura ambiente) que distorsionan la respuesta natural del sistema.

La evaluación se realiza bajo el \textbf{Entorno Controlado} descrito en la Sección~\ref{sssec:entorno-controlado}, el cual aísla el sistema de perturbaciones variables manteniendo condiciones constantes: irradiancia solar de \qty{800}{\watt\per\meter\squared}, temperatura ambiente de \qty{30}{\degreeCelsius} y velocidad del viento de \qty{5}{\meter\per\second}.

El protocolo de prueba consiste en una secuencia de dos etapas:
\begin{enumerate}
    \item \textbf{Pre-estabilización:} Se inicia la simulación con el panel a temperatura ambiente (\qty{30}{\degreeCelsius}) y el controlador operando con una referencia inicial de $Ref = \qty{45}{\degreeCelsius}$. Se permite que el sistema evolucione durante una hora ($t=0$ a $t=\qty{3600}{\second}$) hasta alcanzar el equilibrio.
    \item \textbf{Prueba de Escalón (Step Test):} En el instante $t=\qty{1}{\hour}$, se aplica un cambio tipo escalón en la referencia, aumentando su valor a \qty{55}{\degreeCelsius}.
\end{enumerate}

El análisis de métricas temporales ($T_r, T_s, M_p, e_{ss}$) se aplica específicamente sobre la respuesta del sistema durante esta segunda etapa (transición de \qty{45}{\degreeCelsius} a \qty{55}{\degreeCelsius}).

La Figura~\ref{fig:plot:entorno-controlado} ilustra la respuesta temporal del sistema durante la prueba. Se observa la evolución de la temperatura (línea azul) intentando alcanzar la nueva referencia (línea roja discontinua) a partir del segundo cambio de escalón.

\begin{figure}[H]
    \centering
    \caption{Respuesta transitoria del sistema controlado ante un escalón de referencia de \qty{45}{\degreeCelsius} a \qty{55}{\degreeCelsius}.}
    \label{fig:plot:entorno-controlado}
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/entorno-controlado-temp-panel.pdf}
        \caption{Temperatura (\si{\degreeCelsius}) del panel.}
        \label{fig:plot:entorno-controlado-a}
    \end{subfigure}
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/entorno-controlado-volt.pdf}
        \caption{Tensión (\si{\volt}) aplicada en los actuadores.}
        \label{fig:plot:entorno-controlado-b}
    \end{subfigure}
\end{figure}

A partir de esta respuesta, se calcularon las métricas de desempeño definidas en la metodología. Los resultados se presentan en la Tabla~\ref{tab:metricas}.

\begin{table}[H]
    \centering
    \begin{tabular}{|l|c|c|}
        \hline
        \textbf{Métrica}               & \textbf{Símbolo} & \textbf{Valor Obtenido}    \\
        \hline
        Tiempo de Subida               & $T_r$            & \qty{16.81}{\minute}       \\
        Tiempo de Estabilización (1\%) & $T_s$            & \qty{21.56}{\minute}       \\
        Sobrepaso Máximo               & $M_p$            & \qty{0.13}{\degreeCelsius} \\
        Error de Estado Estacionario   & $e_{ss}$         & \qty{5.54}{\degreeCelsius} \\
        \hline
    \end{tabular}
    \caption{Resumen de métricas de desempeño temporal para $K_c = -0.25$.}
    \label{tab:metricas}
\end{table}

\subsection*{Análisis de Desempeño}

A partir de los datos obtenidos en la Tabla~\ref{tab:metricas}, se desprenden las siguientes conclusiones técnicas sobre la calidad del control implementado:

\begin{enumerate}
    \item \textbf{Respuesta Subamortiguada con Oscilación Residual:}
          Se registra un sobrepaso máximo de \qty{0.13}{\degreeCelsius} y una oscilación sostenida de baja amplitud en torno al valor final. Esto clasifica el comportamiento como \textbf{subamortiguado}.
          Si bien existe oscilación perpetua (ciclo límite), su amplitud es marginal ($< 0.3\%$ de la referencia). En términos prácticos, esta magnitud es despreciable frente a la inercia térmica del panel y no representa un riesgo de fatiga mecánica para los actuadores ni estrés térmico para el material.

    \item \textbf{Dinámica Temporal ($T_r, T_s$):}
          Los tiempos de respuesta (subida en $\approx \qty{17}{\minute}$ y estabilización en $\approx \qty{22}{\minute}$) confirman la alta inercia térmica de la masa de agua. El controlador respeta la dinámica natural de la planta sin forzar una actuación agresiva que podría saturar innecesariamente la bomba, logrando un compromiso adecuado entre velocidad de enfriamiento y suavidad operativa.

    \item \textbf{Margen de Seguridad Pasivo ($e_{ss}$):}
          Se observa un Error de Estado Estacionario de \qty{5.54}{\degreeCelsius}. Al utilizar un controlador Proporcional sin acción integral, este error es matemáticamente esperado.
          Es fundamental notar la dirección del error: la temperatura se estabiliza en $\approx \qty{49.5}{\degreeCelsius}$ para una referencia de \qty{55}{\degreeCelsius}. Esto actúa como un \textbf{margen de seguridad} de casi \qty{6}{\degreeCelsius} a favor del sistema, garantizando que la temperatura operativa se mantenga lejos del límite crítico de degradación.
\end{enumerate}

\section{Validación ante Escenarios de Perturbación Dinámica}

Una vez verificado el desempeño transitorio en condiciones ideales, se sometió el sistema de control a los perfiles de perturbación de 24 horas definidos en la metodología. El objetivo de esta sección es validar la capacidad del controlador para mantener la temperatura del panel dentro de los límites de seguridad ($T_p < \SI{55}{\degreeCelsius}$) bajo distintas condiciones operativas.

A continuación, se analiza la respuesta del sistema controlado ($K_c = -0.25$) frente a los tres escenarios climáticos planteados.

\subsection{Escenario 1: Carga Máxima (Día Despejado)}

Se simuló el comportamiento bajo el perfil de ``Día Soleado'', el cual representa la condición más exigente para los actuadores (irradiancia pico de \qty{1000}{\watt\per\meter\squared}).

\begin{figure}[H]
    \centering
    \caption{Simulaciones del controlador para un día soleado/despejado}
    \label{fig:plot:dia-despejado}
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/dia-despejado-temp-panel.pdf}
        \caption{Temperatura (\si{\degreeCelsius}) del panel.}
        \label{fig:plot:dia-despejado-a}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/dia-despejado-volt.pdf}
        \caption{Tensión (\si{\volt}) aplicada a los actuadores.}
        \label{fig:plot:dia-despejado-b}
    \end{subfigure}
\end{figure}
\paragraph{Análisis}
\begin{itemize}
    \item \textbf{Seguridad Térmica:} Durante las horas de máxima radiación, la temperatura se estabiliza por debajo de los \qty{50}{\degreeCelsius}, cumpliendo holgadamente el requisito de seguridad ($< \SI{55}{\degreeCelsius}$) en el peor caso posible.
    \item \textbf{Actuación Progresiva:} La señal de control evoluciona suavemente siguiendo la curva solar, sin presentar saturaciones bruscas que dañen los motores.
\end{itemize}

\subsection{Escenario 2: Carga Reducida (Día Nublado)}

Este escenario simula un día con baja irradiancia ($G_{max} = \qty{500}{\watt\per\meter\squared}$), útil para verificar que el sistema no desperdicie energía sobre-enfriando el panel cuando no es necesario.

\begin{figure}[H]
    \centering
    \caption{Simulaciones del controlador para un día nublado.}
    \label{fig:dia-nublado}
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/dia-nublado-temp-panel.pdf}
        \caption{Temperatura (\si{\degreeCelsius}) del panel.}
        \label{fig:dia:nublado-a}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/dia-nublado-volt.pdf}
        \caption{Tensión (\si{\volt}) aplicada a los actuadores}
        \label{fig:dia:nublado-b}
    \end{subfigure}
\end{figure}

\paragraph{Análisis}
\begin{itemize}
    \item \textbf{Adaptabilidad Energética:} Se observa que, debido a la menor carga térmica, el esfuerzo de control (voltaje) es significativamente menor que en el día despejado.
    \item \textbf{Prevención de Sobre-enfriamiento:} El sistema mantiene la temperatura cercana a la referencia sin forzar los actuadores al máximo, validando que el algoritmo proporcional ajusta su intensidad según la demanda real.
\end{itemize}

\subsection{Escenario 3: Variación Rápida (Día Intermitente)}

Finalmente, se evaluó la respuesta ante cambios abruptos de nubosidad para probar la velocidad de reacción del lazo cerrado.

\begin{figure}[H]
    \centering
    \caption{Simulaciones del controlador para un día parcialmente nublado (Intermitente).}
    \label{fig:plot:dia-intermitente}
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/dia-intermitente-temp-panel.pdf}
        \caption{Temperatura (\si{\degreeCelsius}) del panel.}
        \label{fig:plot:dia-intermitente-a}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{plots/dia-intermitente-volt.pdf}
        \caption{Tensión (\si{\volt}) aplicada a los actuadores.}
        \label{fig:plot:dia-intermitente-b}
    \end{subfigure}
\end{figure}

\paragraph{Análisis}
\begin{itemize}
    \item \textbf{Rechazo a Perturbaciones:} Al producirse una caída abrupta de irradiancia (paso de nube), el controlador reduce casi instantáneamente el voltaje de los actuadores, evitando el gasto innecesario de energía.
    \item \textbf{Estabilidad:} A pesar de la naturaleza cuadrada de la perturbación solar, la temperatura del panel varía suavemente gracias a la inercia térmica, manteniéndose siempre en rangos seguros y estables.
\end{itemize}

\section{Análisis de la Eficiencia Energética}


